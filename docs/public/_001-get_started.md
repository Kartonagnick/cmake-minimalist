
Как начать работать  
-------------------
Автоматика `Minimalist` опирается на несколько простых правил:  
 - Если имя файла или каталога начинатеся с символа `_`, то он будет проигнорирован.  
 - Каталог [deploy](#Каталог-deploy) содержит скрипты и сценарий сборки.  
 - Каталог [include](#Каталог-с-публичными-заголовками) содержит публичные хэдеры.  
 - Каталог [sources](#Каталог-с-исходниками) содержит приватные хэдеры и .cpp  
 - Каталог [resource](#Каталог-ресурсов) содержит юнит-тесты.  
 - Каталог [test](#Каталог-тестов) содержит юнит-тесты.  
 - Определение [цели](#Цели-сборки) сборки.  
 - Определение [типов](#Тип-цели-сборки) целей сборки.  
 - Определение [зависимостей](#Зависимости-цели-сборки) целей сборки.  


Типичный проект:  
```
sample.lib
 |
 |--- deploy
 |     |--- cmake/CMakeLists.txt
 |      `-- make.bat
 |
 |--- include/sample
 |     |--- sample.hpp
 |      `-- confbuild.hpp
 |
 |--- sources
 |     |--- sample.cpp
 |      `-- pch.hpp
 |
 |--- resource
 |      `-- *.png
 |
 |--- test
 |     |--- resource
 |     |      `-- *.json
 |     |--- include
 |      `-- sources
 |           |--- test-sample.cpp
 |            `-- pch.hpp
 |
  `-- project.root
```

project.root
------------
- Если этот файл существует, то он должен быть в корне проекте.  
- Файл содержит глобальные настройки проекта.  
  - `INCLUDE_CONFIGURATIONS` список поддерживаемых конфигураций.  
  - `EXCLUDE_CONFIGURATIONS` список неподдерживаемых конфигураций.  
  - `VERSION` версия продукта.  

Каталог deploy
--------------
Содержит инструменты сборки:  
  - make.bat запускает сборку.  
  - cmake/CMakeLists.txt содержит сценарий сборки на языке cmake.  
    - CMakeLists.txt передаст управление Minimalist

Каталог с исходниками  
---------------------
 - Может называться: `sources`, `source` или `src`  
 - В нем могут располагаться:  
   - Файлы исходного кода .cpp  
   - Приватные хэдера .hpp  
   - Предварительно скомпилированный заголовок:  
     - Может иметь имя: `pch.hpp`, `precompiled.hpp` или `stdafx.hpp`  
   - Файл с ресурсами:  
     - Обычно его имя совпадает с именем цели сборки: `sample.rc`  
   - Файл с описанием библиотеки импорта:  
     - Обычно его имя совпадает с именем цели сборки: `sample.def`  


Каталог с публичными заголовками  
--------------------------------
 - Все обнаруженные `include` добавляются в списки путей, где компилятор ищет заголовки.  
 - Все обнаруженные внутри `.hpp` автоматом добавляются в дерево проекта.  
 - Файл `confbuild.hpp` содержит версию продукта.  


Каталог тестов  
--------------
 - Если каталог цели сборки содержит слово `test*`, то данная цель - юнит-тест.  
 - К юнит-тестам автоматически подключается фреймворк для тестирования:  
   - Это может быть mygtest (gtest/gmock)  


Каталог ресурсов  
----------------
 - Имеет имя `resource`  
 - Содержимое этого каталога автоматически копируется к бинарнику программы.  


Предварительно скомпилированный заголовок  
-----------------------------------------
 - Может иметь имя: `pch.hpp`, `precompiled.hpp` или `stdafx.hpp`  
 - При обнаружении подключается автоматически.  


Описатель библиотека импорта  
----------------------------
 - Имеет расширение: `*.def`
 - Обычно имя совпадает с именем цели сборки.  
   - Пример: `sample.def`
 - При обнаружении подключается автоматически.  


Файл с ресурсами  
----------------
 - Имеет расширение: `*.rc`  
 - Обычно имя совпадает с именем цели сборки.  
   - Пример: `sample.rc`  
 - При обнаружении подключается автоматически.  


Цели сборки  
-----------
Цель сборки определяется в CMakeFiles.txt  
Пример:  

```
make_target(
    NAME               "application"   имя цели сборки
    PATH_TO_SOURCES    "sample"        путь к каталогу цели относительно корня проекта
    TYPE               EXECUTABLE      тип цели
    SHORT                              короткий тип цели (например - bin)
    SPECIALIZATION                     специализация (сейчас поддерживается только UNIT_TEST)
    LANGUAGE                           можно задать дополнительно язык (CXX или C или какой либо ещё)
    INCLUDES           "C:/include"    список путей к публичным заголовкам
    HEADERS            "sample.hpp"    список заголовков
    SOURCES            "sample.сpp"    список исходников
    RESOURCES          "c:/resource"   список путей к ресурсам
    PREPROCESSOR       "VALUE=123"     список дефайнов препроцессора
    DEPENDENCIES       "prog"          список имен целей сборки от которых зависит текущая цель
    PATHS_LIBRARIES    "C:/libs"       список путей для поиска внешних библиотек 
    NAMES_LIBRARIES    "expat"         список имен внешних библиотек для линковки
    ADD_HEADERS        "C:/add_inc"    по этим путям нужно подтянуть заголовки
    ADD_SOURCES        "C:/add_cpp"    по этим путям нужно подтянуть исходники
)

```
Все параметры опциональны.  

  - **NAME** - позволяет указать конкретное имя цели сборки.  
    По умолчанию имя цели совпадает с именем её каталога.  
    Имя цели сборки сохраняется в переменную `TARGET_NAME`  
    И в дальнейшем может быть использованно при раскрытии суффика:  
    ```
    set "eSUFFIX={COMPILER_TAG}-{BUILD_TYPE}-{ADDRESS_MODEL}-{RUNTIME_CPP}/{TARGET_TYPE}-{TARGET_NAME}" 
    ```

  - **PATH_TO_SOURCES** - путь к каталогу цели.  
    Относительный путь задаётся относительно каталога проекта.  
    По умолчанию совпадает с каталогом проекта.  

  - **TYPE** - [тип цели](#Тип-цели-сборки)  
    По умолчанию тип цели зависит от содержимого её каталога.  

  - **SHORT** - сокращенная (обычно трёх буквенная) запись типа сборки.  
    Отвечает за формирование итоговых путей продуктов сборки.  
    По умолчанию выводится из `TYPE`  

  - **SPECIALIZATION** - специализация цели.  
    Поддерживается только одна: UNIT_TEST.  
    Автоматически устанавливается для целей, которые содержатся в подкаталоге `test-*`  
    Для юнит-тестов автоматически подключается mygtest и gtest/gmock.  



`LANGUAGE` - по умолчанию язык с++  





TYPE. Тип цели сборки  
---------------------
Проект может состоять из нескольких целей сборки.  
Например, статическая библиотека, юнит-тесты, и запускаемое приложение.  

Типы целей определяются по их названию или содержимому:  

  - `EXECUTABLE` Цель является запускаемым приложением, 
                 если она содержит файл main.cpp  

  - `SHARED_LIBRARY` Цель является динамической библиотекой, 
                     если она содержит файл dllmain.cpp  

  - `UNIT_TEST` Цель является юнит-тестом, если в путях к её каталогу фигурирует слово `test*`  
                К юнит-тестам автоматически подлинковывается фреймворк для тестирования.  
  
  - `HEADER_ONLY` Библиотека из одних лишь заголовочных файлов.  

  - `STATIC_LIBRARY` Цель является статической библиотекой, 
                     если не попала ни в одну из предыдущих категорий.  

Кроме того, тип цели можно указать вручную.  
Тип цели влияет на TYPE_SHORT, который участвует в формировании путей продуктов сборки.  


TYPE_SHORT. Сокращенная форма записи типа сборки  
------------------------------------------------

Сокращенная форма записи типа цели сборки.  



Зависимости цели сборки  
-----------------------
Одни цели сборки могут зависить от других.  
Кроме того, цель сборки может зависеть от внешних библиотек.  


